<?php    include '../../PHP/public.php';    function handlePost(){        $keyList=array('img','pos','url');        $dir=array();        if(!isset($_GET['id'])){            return;        }        $id=$_GET['id'];        foreach($keyList as $a){            if($a=='img'){                if(isset($_FILES["img"])){                    if ($_FILES["img"]["error"] > 0){                        alert("图片上传错误");                    }else if((int)$_FILES["img"]["size"] >2*1024*1024){                        alert("图片太大");                    }else{                        $arr=$_FILES["img"];                        $picName=$arr['name'];                        $hz=explode('.',$picName);                        $hz=$hz[count($hz)-1];                        $stringtime = date('Y-m-d H:i:s',time());                        $picUrl='../../advPics/'.strtotime($stringtime).".".$hz;                        if(!file_exists($picUrl)&&move_uploaded_file($arr['tmp_name'],$picUrl)){                            $dir[$a]=$picUrl;                            continue;//上传成功                        }                        alert("图片上传错误");                    }                }                return;            }else if(isset($_POST[$a])&&$_POST[$a]!=""){                $dir[$a]=$_POST[$a];            }else{                if(isset($_POST[$a]))                    alert("某些数据非法");                return;            }        }        $con= consql();        if($con){            $sql="select img from adv where id=$id";            $res= mysqli_query($con,$sql);            if($row=mysqli_fetch_array($res,MYSQL_NUM)){                 if(!unlink($row[0])&&!unlink("../".$row[0])){                    echo "删除图片失败";                }            }else{                echo "删除图片失败";            }            $sql= getSqlsen_update('adv', $dir,"id=$id","111");            if($res=mysqli_query($con,$sql)){                alert("更新成功");            }        }    }    handlePost();    jumpUrl("../adv.php");?>